<button
  mat-icon-button
  (click)="infoboxExtended = !infoboxExtended"
>
  <mat-icon>{{ infoboxExtended ? 'layers_clear' : 'layers' }}</mat-icon>
</button>

<mat-card *ngIf="infoboxExtended">

  <mat-accordion>

    <mat-expansion-panel expanded="true">
      <mat-expansion-panel-header>
          <mat-panel-title>Krankenhäuser - Bettenauslatung</mat-panel-title>
      </mat-expansion-panel-header>

      <p>
        <mat-slide-toggle
            [checked]="mo.bedGlyphOptions.enabled"
            (change)="mo.bedGlyphOptions.enabled = $event.checked; emitMapOptions()"
          >Bettenauslatung anzeigen / ausblenden
          </mat-slide-toggle>
      </p>

      <mat-divider></mat-divider>

      <h5>Aggregation</h5>

      <mat-button-toggle-group
        class="btngrp"
        name="fontStyle"
        aria-label="Font Style"
        [value]="mo.bedGlyphOptions.aggregationLevel"
        (change)="updateBedGlyphAggregationLevel($event.value)"
      >
        <mat-button-toggle [value]="aggregationLevels.state" matTooltip="Bundesländer">Länder</mat-button-toggle>
        <mat-button-toggle [value]="aggregationLevels.governmentDistrict" matTooltip="Regierungsbezirke">Bezirke</mat-button-toggle>
        <mat-button-toggle [value]="aggregationLevels.county" matTooltip="Landkreise">Kreise</mat-button-toggle>
        <mat-button-toggle [value]="aggregationLevels.none" matTooltip="Ohne Aggregation">Keine</mat-button-toggle>
      </mat-button-toggle-group>

      <mat-divider></mat-divider>

      <h5>Glyph</h5>

      <div class="glyph-legend">
          <div 
              *ngFor="let t of glyphLegend" 
              class="glyph-tile" 
              [matTooltip]="t.description"
              (click)="mo.bedGlyphOptions[t.accessor] = !mo.bedGlyphOptions[t.accessor]; emitMapOptions()"
          >
              <div class="rect" [ngStyle]="{'background-color': getGlyphColor(t.color), 'border-color': mo.bedGlyphOptions[t.accessor] ? 'grey' : 'lightgrey'}"></div>
              <div class="text">{{ t.name }}</div>
          </div>
      </div>
      <div class="glyph-color-legend">
          <div 
              *ngFor="let t of glyphLegendColors" 
              class="glyph-tile" 
              
          >
              <div class="circle" [ngStyle]="{'background-color': getGlyphColor(t)}"></div>
              <div class="text">{{ t }}</div>
          </div>
      </div>

      <mat-divider></mat-divider>

      <h5>Hintergrund</h5>

        <mat-slide-toggle
              [disabled]="mo.bedGlyphOptions.aggregationLevel === aggregationLevels.none"
              [checked]="mo.bedBackgroundOptions.enabled"
              (change)="mo.bedBackgroundOptions.enabled = !mo.bedBackgroundOptions.enabled; emitMapOptions()"
            >Bettenauslatung im Hintergrund anzeigen / ausblenden
            </mat-slide-toggle>
        <div *ngIf="mo.bedGlyphOptions.aggregationLevel === aggregationLevels.none">
          <mat-error>Bitte eine Aggregation Länder, Bezirke, oder Kreise auswählen.</mat-error>
        </div>
        

      <mat-button-toggle-group
        *ngIf="mo.bedBackgroundOptions.enabled"
        class="btngrp"
        name="fontStyle"
        aria-label="Font Style"
        [value]="mo.bedBackgroundOptions.bedType"
        (change)="updateBedBackgroundBedType($event.value)"
        [disabled]="mo.bedGlyphOptions.aggregationLevel === aggregationLevels.none"
      >
        <mat-button-toggle [value]="glyphStates.icuLow">ICU low</mat-button-toggle>
        <mat-button-toggle [value]="glyphStates.icuHigh">ICU high</mat-button-toggle>
        <mat-button-toggle [value]="glyphStates.ecmo">ECMO</mat-button-toggle>
      </mat-button-toggle-group>
    </mat-expansion-panel>




    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>Fallansicht</mat-panel-title>
      </mat-expansion-panel-header>
      <form class="covid-form">
        <mat-slide-toggle
          [checked]="mo.covidNumberCaseOptions.enabled"
          (change)="updateCovidNumberCaseOptionsEnabled($event.checked)"
        >Covid-19 Fallansicht anzeigen / ausblenden
        </mat-slide-toggle>

        <div *ngIf="mo.covidNumberCaseOptions && mo.covidNumberCaseOptions.enabled">
          <div class="toggleGroup">
            <h5>Zeitraum</h5>
            <mat-button-toggle-group
            *ngIf="mo.covidNumberCaseOptions && mo.covidNumberCaseOptions.enabled"
            class="btngrp"
            name="fontStyle"
            aria-label="Font Style"
            [value]="mo.covidNumberCaseOptions.timeWindow"
            (change)="mo.covidNumberCaseOptions.timeWindow = $event.value; emitMapOptions()"
          >
            <mat-button-toggle [value]="covidNumberCaseTimeWindow.all" [disabled]="mo.covidNumberCaseOptions.change == covidNumberCaseChange.relative">Alle Daten</mat-button-toggle>
            <mat-button-toggle [value]="covidNumberCaseTimeWindow.twentyFourhours">letze 24 Stunden</mat-button-toggle>
            <mat-button-toggle [value]="covidNumberCaseTimeWindow.seventyTwoHours">letzte 72 Stunden</mat-button-toggle>
          </mat-button-toggle-group>
          </div>

          <mat-divider></mat-divider>

          <div class="toggleGroup">
            <h5>Fallzahlen</h5>
            
            <mat-button-toggle-group
            class="btngrp"
            name="fontStyle"
            aria-label="Font Style"
            [value]="mo.covidNumberCaseOptions.change"
            (change)="mo.covidNumberCaseOptions.change = $event.value; emitMapOptions()"
          >
            <mat-button-toggle [value]="covidNumberCaseChange.absolute">Alle erfassen Fälle</mat-button-toggle>
            <mat-button-toggle [value]="covidNumberCaseChange.relative" [disabled]="covidNumberCaseTimeWindow.all == mo.covidNumberCaseOptions.timeWindow">Veränderung im gewählten Zeitraum</mat-button-toggle>
          </mat-button-toggle-group>
          </div>

          <mat-divider></mat-divider>

          <div class="toggleGroup">
            <h5>Art</h5>
            
            <mat-button-toggle-group
            class="btngrp"
            name="fontStyle"
            aria-label="Font Style"
            [value]="mo.covidNumberCaseOptions.type"
            (change)="mo.covidNumberCaseOptions.type = $event.value; emitMapOptions()"
          >
            <mat-button-toggle [value]="covidNumberCaseType.cases">Erkrankungen</mat-button-toggle>
            <mat-button-toggle [value]="covidNumberCaseType.deaths">Todesfälle</mat-button-toggle>
          </mat-button-toggle-group>
          </div>

          <mat-divider></mat-divider>

          <div class="toggleGroup">
            <h5>Normalisierung</h5>

            <mat-button-toggle-group
            class="btngrp"
            name="fontStyle"
            aria-label="Font Style"
            [value]="mo.covidNumberCaseOptions.normalization"
            (change)="mo.covidNumberCaseOptions.normalization = $event.value; emitMapOptions()"
          >
            <mat-button-toggle [value]="covidNumberCaseNormalization.absolut">Keine Normalisierung</mat-button-toggle>
            <mat-button-toggle [value]="covidNumberCaseNormalization.per100k" [disabled]="mo.covidNumberCaseOptions.change == covidNumberCaseChange.relative">Je 100.000 Einwohner</mat-button-toggle>
          </mat-button-toggle-group>
          </div>
        </div>

      </form>

    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Diverse Ansichten
        </mat-panel-title>
        <mat-panel-description>
          <!-- description -->
        </mat-panel-description>
      </mat-expansion-panel-header>

      <div>
        <mat-slide-toggle
          [checked]="mo.showOsmHospitals"
          (change)="mo.showOsmHospitals = !mo.showOsmHospitals; emitMapOptions()"
        >Alle Krankenhäuser
        </mat-slide-toggle>
      </div>
      <div>
        <mat-slide-toggle
          [checked]="mo.showOsmHeliports"
          (change)="mo.showOsmHeliports = !mo.showOsmHeliports; emitMapOptions()"
        >Hubschrauberlandeplätze
        </mat-slide-toggle>
      </div>

    </mat-expansion-panel>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          Quellen
        </mat-panel-title>
      </mat-expansion-panel-header>


      <mat-list role="list">
        <mat-list-item role="listitem">
          <a href="https://www.divi.de/register/intensivregister" target="_blank">DIVI Intensivregister</a>
        </mat-list-item>
      </mat-list>


    </mat-expansion-panel>
  </mat-accordion>


</mat-card>
